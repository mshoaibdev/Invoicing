import{_ as X}from"./ConfirmDialog-29549557.js";import{_ as Y}from"./AppTextField-2e476594.js";import{u as Z}from"./invoices-9be41dd7.js";import{f as ee}from"./formatters-12413ec5.js";import ae from"./ViewInvoice-c54dbaea.js";import{_ as te}from"./SendInvoice-714b41fc.js";import{aB as d,am as oe,aG as ne,b0 as o,at as l,n as u,bk as a,y as t,bt as se,q as s,bv as z,bx as ie,x as g,o as p,a5 as v,cc as le,bw as A,by as re,p as P,aU as r,cz as ce,ab as de,cf as m,cv as ue,cs as me,cu as y,bu as pe}from"./main-70b82271.js";import{a as ve,V as $}from"./VRow-498fad85.js";import{V as _e}from"./VDataTableServer-09952818.js";import"./lodash-bc5bedbb.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-628b2924.js";import"./DialogCloseBtn-478619bf.js";import"./VTable-163fc7a0.js";import"./validators-f8585958.js";import"./filter-73280f75.js";import"./VCheckboxBtn-d416ecdf.js";import"./VSelectionControl-f8a2bfe4.js";const fe={class:"me-3 d-flex gap-3"},ge={class:"d-flex align-center"},ye={key:1},we={class:"d-flex flex-column"},be={class:"text-base"},he={class:"text-sm text-disabled"},Ve={class:"text-h6 font-weight-bold"},Ie={class:"text-sm"},xe=["href"],ke=["href"],Ce={class:"d-flex align-center"},De={class:"me-3"},Pe={class:"d-flex align-center"},$e={class:"mb-0"},Se={class:"d-flex align-center"},Be=["onClick"],Te={key:0,class:"text-grey text-caption align-self-center"},Ue={key:1},ea={__name:"Index",props:{customerId:{type:Number,required:!1}},setup(E){const h=E,{invoices:S,totalRecords:L,isLoading:q,fetchInvoices:V,currentPage:I,headers:M,deleteInvoice:j,itemsPerPage:x,searchQuery:k,paginationData:Ne,filters:F,resolveInvoiceStatusVariantAndIcon:B}=Z(),C=d([]),_=d(!1),f=d(!1),w=d(!1),b=d(0),G=d(0),T=d({});oe(async()=>{h.customerId&&(G.value=h.customerId,F.customerId=h.customerId),await V()});const D=d([]);(()=>{const i=JSON.parse(localStorage.getItem("invoices.table"));i?D.value=i.filter(n=>n.visible===!0):D.value=M})();const J=async i=>{T.value=i,w.value=!0},O=i=>{b.value=i,isEditInvoiceDialogVisible.value=!0},U=i=>{b.value=i,f.value=!0},N=i=>{_.value=!0,b.value=i},Q=async i=>{if(i===!1){_.value=!1;return}await j(b.value),_.value=!1,f.value=!1,await V()};return(i,n)=>{const H=Y,K=ne("IconBtn"),W=X;return o(S)?(l(),u(pe,{key:0,id:"invoice-list"},{default:a(()=>[t(se,{class:"d-flex align-center flex-wrap gap-4"},{default:a(()=>[t(ve,null,{default:a(()=>[t($,{lg:"3",md:"3",sm:"4",cols:"12"},{default:a(()=>[s("div",fe,[o(z).can("Create","invoices-create")?(l(),u(ie,{key:0,"prepend-icon":"tabler-plus",to:{name:"create-invoice"}},{default:a(()=>[g(" Create Invoice ")]),_:1})):p("",!0)])]),_:1}),t($,{lg:"6",md:"6",sm:"8",cols:"12"}),t($,{lg:"3",md:"3",cols:"12",sm:"6"},{default:a(()=>[t(H,{modelValue:o(k),"onUpdate:modelValue":n[0]||(n[0]=e=>v(k)?k.value=e:null),label:"Search Invoices",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(le),t(o(_e),{modelValue:o(C),"onUpdate:modelValue":n[1]||(n[1]=e=>v(C)?C.value=e:null),"items-per-page":o(x),"onUpdate:itemsPerPage":n[2]||(n[2]=e=>v(x)?x.value=e:null),page:o(I),"onUpdate:page":n[3]||(n[3]=e=>v(I)?I.value=e:null),loading:o(q),"items-length":o(L),headers:o(D),items:o(S),class:"text-no-wrap"},{"item.invoice_id":a(({item:e})=>{var c;return[s("div",ge,[t(A,{variant:"tonal",class:"me-3",size:"38",color:"primary"},{default:a(()=>{var R;return[e.raw.company?(l(),u(re,{key:0,src:e.raw.company.logo_url},null,8,["src"])):(l(),P("span",ye,r((R=e.raw.company)==null?void 0:R.name),1))]}),_:2},1024),s("div",we,[s("h6",be,r((c=e.raw.company)==null?void 0:c.name),1),s("span",he,r(e.raw.invoice_id),1)])])]}),"item.payment_method":a(({item:e})=>[s("h6",Ve,r(e.raw.payment_method.name),1),s("span",Ie,r(e.raw.payment_method.description),1)]),"item.customer.email":a(({item:e})=>[s("a",{href:`mailto:${e.raw.customer.email}`,class:"text-decoration-none"},r(e.raw.customer.email),9,xe)]),"item.customer.phone":a(({item:e})=>[s("a",{href:`tel:${e.raw.customer.phone}`,class:"text-decoration-none"},r(e.raw.customer.phone),9,ke)]),"item.total":a(({item:e})=>[s("div",Ce,[s("span",De,r(o(ee)(e.raw.total)),1)])]),"item.status":a(({item:e})=>[s("div",Pe,[t(ce,null,{activator:a(({props:c})=>[t(A,de({size:30},c,{color:o(B)(e.raw.status).variant,variant:"tonal"}),{default:a(()=>[t(m,{size:20,icon:o(B)(e.raw.status).icon},null,8,["icon"])]),_:2},1040,["color"])]),default:a(()=>[s("p",$e,r(e.raw.status),1)]),_:2},1024)])]),"item.title":a(({item:e})=>[s("div",Se,[s("a",{href:"javascript:;",onClick:c=>U(e.raw.id)},r(e.raw.title),9,Be)])]),"item.actions":a(({item:e})=>[t(K,{density:"compact"},{default:a(()=>[t(m,{icon:"tabler-dots-vertical"}),t(ue,{activator:"parent"},{default:a(()=>[t(me,null,{default:a(()=>[t(y,{to:{name:"edit-invoice",params:{id:e.raw.id}}},{default:a(()=>[t(m,{icon:"tabler-pencil"}),g(" Edit Invoice ")]),_:2},1032,["to"]),["Sent","Draft"].includes(e.raw.status)&&e.raw.payment_method.is_gateway&&e.raw.payment_method!==""?(l(),u(y,{key:0,href:e.raw.payment_link,target:"_blank",rel:"noopener noreferrer"},{default:a(()=>[t(m,{icon:"tabler-credit-card"}),e.raw.payment_link===""&&e.raw.payment_method.name==="PayPal"?(l(),P("span",Te," Link is not available ")):(l(),P("span",Ue,r(e.raw.payment_method.name=="PayPal"?" Pay with PayPal":" Pay Invoice"),1))]),_:2},1032,["href"])):p("",!0),e.raw.status!=="Paid"&&e.raw.payment_method.is_gateway?(l(),u(y,{key:1,onClick:c=>J(e.raw)},{default:a(()=>[t(m,{icon:"tabler-send"}),g(" Send Invoice ")]),_:2},1032,["onClick"])):p("",!0),t(y,{href:e.raw.invoice_link,target:"_blank",rel:"noopener noreferrer",download:""},{default:a(()=>[t(m,{icon:"tabler-download"}),g(" Download Invoice ")]),_:2},1032,["href"]),t(y,{onClick:c=>U(e.raw.id)},{default:a(()=>[t(m,{icon:"tabler-eye"}),g(" View Invoice ")]),_:2},1032,["onClick"]),o(z).can("Delete","invoices-delete")?(l(),u(y,{key:2,onClick:c=>N(e.raw.id)},{default:a(()=>[t(m,{icon:"tabler-trash"}),g(" Delete Invoice ")]),_:2},1032,["onClick"])):p("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","items-per-page","page","loading","items-length","headers","items"]),t(W,{isDialogVisible:o(_),"onUpdate:isDialogVisible":n[4]||(n[4]=e=>v(_)?_.value=e:null),"cancel-title":"Cancelled","confirm-title":"Deleted","confirm-msg":"Invoice deleted successfully.","confirmation-question":"Are you sure you want to delete this invoice? This action cannot be undone.","cancel-msg":"Invoice deletion cancelled.",onConfirm:Q},null,8,["isDialogVisible"]),o(f)?(l(),u(ae,{key:0,isDialogVisible:o(f),"onUpdate:isDialogVisible":n[5]||(n[5]=e=>v(f)?f.value=e:null),"invoice-id":o(b),onEditInvoice:O,onDeleteInvoice:N},null,8,["isDialogVisible","invoice-id"])):p("",!0),o(w)?(l(),u(te,{key:1,isDialogVisible:o(w),"onUpdate:isDialogVisible":n[6]||(n[6]=e=>v(w)?w.value=e:null),invoice:o(T),onRefetch:o(V)},null,8,["isDialogVisible","invoice","onRefetch"])):p("",!0)]),_:1})):p("",!0)}}};export{ea as default};
