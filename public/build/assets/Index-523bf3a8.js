import{V as we,_ as xe}from"./VDataTableServer-84efd4e3.js";import{V as ke,_ as z,b as K,d as $e,a as Ie,c as Ue}from"./VTextarea-bfeb20e3.js";import{_ as re}from"./AppTextField-9867e25c.js";import{u as Z,l as me,a as he,_ as Se,b as Ee}from"./Add-bc5c5574.js";import{a3 as Ae,o as ee,a as p,c as f,w as l,b as t,d as o,t as b,u as e,V as $,g as I,ab as Be,ac as Ne,r as C,a6 as Te,h as g,af as Re,e as Le,U,f as de,E as W}from"./main-c40ee4ed.js";import{V as J,a as te,d as Fe}from"./VCard-a375baf5.js";import{a as le,V as v}from"./VRow-db2c24e9.js";import{V as X}from"./VList-4b19a862.js";import{V as G}from"./VDialog-fe67dd57.js";import{_ as Pe}from"./AppDateTimePicker-4011cefb.js";import{V as Me,r as R,e as qe}from"./VForm-48297921.js";import{A as je}from"./Add-38c6b271.js";import Ye from"./Index-b79497ab.js";import Je from"./Index-cb061778.js";import{V as Oe}from"./VDivider-e4e61359.js";import{V as Qe}from"./VSwitch-989e8f38.js";import"./VCheckboxBtn-609a0dc2.js";import"./VSelectionControl-84b50376.js";import"./VInput-135e03cb.js";import"./transition-127812ba.js";import"./VTextField-1b1d5e52.js";import"./forwardRefs-9d31fcaa.js";import"./VImg-3d39c17f.js";import"./VMenu-ebdbfbe8.js";import"./VOverlay-93ac4317.js";import"./VAvatar-1c4c29a7.js";import"./axios-da837377.js";import"./parse-263515be.js";import"./index.m-120058be.js";import"./_commonjsHelpers-725317a4.js";import"./formatters-12413ec5.js";import"./VBadge-4b3a10d7.js";const x=_=>(Be("data-v-bcc34db6"),_=_(),Ne(),_),We=x(()=>o("p",{class:"text-sm text-uppercase text-disabled"}," Customer Details ",-1)),ze=x(()=>o("th",null," Customer Name: ",-1)),Ge=x(()=>o("th",null," Email: ",-1)),He=["href"],Ke=x(()=>o("th",null," Phone: ",-1)),Xe=["href"],Ze=x(()=>o("th",null," Address: ",-1)),et=x(()=>o("th",null," Lead Type: ",-1)),tt=x(()=>o("th",null," Status ",-1)),lt=x(()=>o("th",null," Lead Representative: ",-1)),st=x(()=>o("th",null," In Progress: ",-1)),at=x(()=>o("th",null," Last Service: ",-1)),ot=x(()=>o("th",null," Date Added: ",-1)),it=x(()=>o("p",{class:"text-sm text-uppercase text-disabled text-center"}," Email ",-1)),nt=x(()=>o("p",{class:"text-sm text-uppercase text-disabled text-center mt-2"}," Service history ",-1)),ut=x(()=>o("p",{class:"text-sm text-uppercase text-disabled text-center"}," Schedule ",-1)),dt={class:"d-flex justify-space-between py-1"},rt=x(()=>o("h6",{class:"text-h6"}," Notes: ",-1)),mt={class:"text-body-1"},ct={__name:"View",props:{isDialogVisible:{type:Boolean,required:!0},customerId:{type:Number,required:!0}},emits:["update:isDialogVisible","editCustomer","deleteCustomer","createEstimate","viewEstimates","viewInvoices","createInvoice"],setup(_,{emit:V}){const y=_,{updateCustomer:h,errors:k,respResult:B,isLoading:L,getCustomer:F,customerData:d}=Z();ee(async()=>{y.isDialogVisible&&await F(y.customerId)});const n=async s=>{V("createEstimate",s)},E=async s=>{V("createInvoice",s)},P=async s=>{V("viewEstimates",s)},q=async s=>{V("viewInvoices",s)},O=async s=>{V("deleteCustomer",s)},j=async s=>{V("editCustomer",s)},m=s=>{V("update:isDialogVisible",s)};return(s,r)=>{const S=z;return p(),f(G,{width:s.$vuetify.display.smAndDown?600:"60%","model-value":_.isDialogVisible,"onUpdate:modelValue":m},{default:l(()=>[t(S,{onClick:r[0]||(r[0]=D=>m(!1))}),t(J,null,{default:l(()=>[t(te,null,{default:l(()=>[t(le,null,{default:l(()=>[t(v,{cols:"12",lg:"3",md:"6",sm:"6"},{default:l(()=>[We,t(ke,null,{default:l(()=>[o("tbody",null,[o("tr",null,[ze,o("td",null,b(e(d).name),1)]),o("tr",null,[Ge,o("td",null,[o("a",{href:`mailto:${e(d).email}`},b(e(d).email),9,He)])]),o("tr",null,[Ke,o("td",null,[o("a",{href:`tel:${e(d).phone}`},b(e(d).phone),9,Xe)])]),o("tr",null,[Ze,o("td",null,b(e(d).address),1)]),o("tr",null,[et,o("td",null,b(e(d).lead_type),1)]),o("tr",null,[tt,o("td",null,b(e(d).status),1)]),o("tr",null,[lt,o("td",null,b(e(d).lead_representative),1)]),o("tr",null,[st,o("td",null,b(e(d).in_progress?"Yes":"No"),1)]),o("tr",null,[at,o("td",null,b(e(d).last_service),1)]),o("tr",null,[ot,o("td",null,b(e(d).date),1)])])]),_:1})]),_:1}),t(v,{cols:"12",lg:"3",md:"6",sm:"6"},{default:l(()=>[it,t(X,{class:"text-left mt-2"},{default:l(()=>[t($,{block:"",variant:"text",class:"mt-2",onClick:r[1]||(r[1]=D=>E(e(d).id))},{default:l(()=>[I(" Create Invoice ")]),_:1}),t($,{block:"",variant:"text",class:"mt-2",onClick:r[2]||(r[2]=D=>n(e(d).id))},{default:l(()=>[I(" Create Estimate ")]),_:1}),t($,{block:"",variant:"text",class:"mt-2"},{default:l(()=>[I(" Download Receipt ")]),_:1}),t($,{block:"",variant:"text",class:"mt-2"},{default:l(()=>[I(" Review ")]),_:1})]),_:1}),nt,t(X,{class:"text-left"},{default:l(()=>[t($,{block:"",variant:"text",onClick:r[3]||(r[3]=D=>P(e(d).id))},{default:l(()=>[I(" Estimates ")]),_:1}),t($,{block:"",variant:"text",class:"mt-2",onClick:r[4]||(r[4]=D=>q(e(d).id))},{default:l(()=>[I(" Invoices ")]),_:1})]),_:1})]),_:1}),t(v,{cols:"12",lg:"3",md:"6",sm:"6"},{default:l(()=>[ut,t(X,{class:"text-left mt-2"},{default:l(()=>[t($,{block:"",variant:"text"},{default:l(()=>[I(" Estimate ")]),_:1}),t($,{block:"",variant:"text"},{default:l(()=>[I(" Service ")]),_:1})]),_:1})]),_:1}),t(v,{cols:"12"},{default:l(()=>[o("div",dt,[rt,o("h5",mt,b(e(d).notes),1)])]),_:1})]),_:1})]),_:1}),t(Fe,{class:"d-flex justify-end"},{default:l(()=>[t($,{color:"primary",text:"",onClick:r[5]||(r[5]=D=>j(e(d).id))},{default:l(()=>[I(" Edit ")]),_:1}),t($,{color:"error",text:"",onClick:r[6]||(r[6]=D=>O(e(d).id))},{default:l(()=>[I(" Delete ")]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},pt=Ae(ct,[["__scopeId","data-v-bcc34db6"]]),ft={__name:"Edit",props:{isDialogVisible:{type:Boolean,required:!0},customerId:{type:Number,required:!0}},emits:["refetchData","update:isDialogVisible"],setup(_,{emit:V}){const y=_,{updateCustomer:h,errors:k,respResult:B,isLoading:L,getCustomer:F,customerData:d}=Z(),n=C({}),E=C(),P=C([]);ee(async()=>{y.isDialogVisible&&(await F(y.customerId),n.value=d.value)});const q=()=>{Re(()=>{var m,s;(m=E.value)==null||m.reset(),(s=E.value)==null||s.resetValidation()})},O=async()=>{var m;(m=E.value)==null||m.validate().then(async({valid:s})=>{s&&(await h(y.customerId,n.value),B.value.status===200&&(V("refetchData"),V("update:isDialogVisible",!1),q()))})},j=m=>{V("update:isDialogVisible",m)};return(m,s)=>{const r=z,S=re,D=Pe;return p(),f(G,{width:m.$vuetify.display.smAndDown?"auto":1e3,"model-value":y.isDialogVisible,persistent:"","onUpdate:modelValue":j},{default:l(()=>[t(r,{onClick:s[0]||(s[0]=u=>j(!1))}),t(J,{title:"Update Customer"},{default:l(()=>[t(te,null,{default:l(()=>[t(Me,{ref_key:"refForm",ref:E,onSubmit:Te(O,["prevent"])},{default:l(()=>[t(le,null,{default:l(()=>[t(v,{cols:"12",md:"6"},{default:l(()=>[t(S,{modelValue:e(n).name,"onUpdate:modelValue":s[1]||(s[1]=u=>e(n).name=u),label:"Customer Name",rules:[e(R)]},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(S,{modelValue:e(n).email,"onUpdate:modelValue":s[2]||(s[2]=u=>e(n).email=u),label:"Email",rules:[e(R),e(qe)]},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(S,{modelValue:e(n).phone,"onUpdate:modelValue":s[3]||(s[3]=u=>e(n).phone=u),label:"Phone",rules:[e(R)]},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(S,{modelValue:e(n).address,"onUpdate:modelValue":s[4]||(s[4]=u=>e(n).address=u),label:"Address",rules:[e(R)]},null,8,["modelValue","rules"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(K,{modelValue:e(n).user_id,"onUpdate:modelValue":s[5]||(s[5]=u=>e(n).user_id=u),label:"Lead Representative","item-title":"name","item-value":"id",items:e(P)},null,8,["modelValue","items"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(K,{modelValue:e(n).lead_type,"onUpdate:modelValue":s[6]||(s[6]=u=>e(n).lead_type=u),label:"Lead Type",rules:[e(R)],"item-title":"name","item-value":"id",items:e(me)},null,8,["modelValue","rules","items"])]),_:1}),t(v,{cols:"12",md:"6"},{default:l(()=>[t(K,{modelValue:e(n).status,"onUpdate:modelValue":s[7]||(s[7]=u=>e(n).status=u),label:"Lead Status",rules:[e(R)],"item-title":"name","item-value":"id",items:e(he)},null,8,["modelValue","rules","items"])]),_:1}),e(n).last_service?(p(),f(v,{key:0,cols:"12",md:"6"},{default:l(()=>[t(D,{modelValue:e(n).date,"onUpdate:modelValue":s[8]||(s[8]=u=>e(n).date=u),rules:[e(R)],density:"compact",placeholder:"Select Date",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",disableMobile:!0}},null,8,["modelValue","rules"])]),_:1})):g("",!0),e(n).last_service?(p(),f(v,{key:1,cols:"12",md:"6"},{default:l(()=>[t(D,{modelValue:e(n).last_service,"onUpdate:modelValue":s[9]||(s[9]=u=>e(n).last_service=u),rules:[e(R)],density:"compact",placeholder:"Last Service Date",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",disableMobile:!0}},null,8,["modelValue","rules"])]),_:1})):g("",!0),t(v,{cols:"12",md:"12"},{default:l(()=>[t($e,{modelValue:e(n).notes,"onUpdate:modelValue":s[10]||(s[10]=u=>e(n).notes=u),clearable:"","clear-icon":"tabler-circle-x",label:"Notes"},null,8,["modelValue"])]),_:1}),t(v,{cols:"12",class:"d-flex flex-wrap gap-4 justify-end"},{default:l(()=>[t($,{type:"submit",loading:e(L),disabled:e(L),onClick:s[11]||(s[11]=u=>{var N;return(N=e(E))==null?void 0:N.validate()})},{default:l(()=>[I(" Update ")]),_:1},8,["loading","disabled"]),t($,{color:"secondary",variant:"tonal",onClick:s[12]||(s[12]=u=>j(!1))},{default:l(()=>[I(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},vt={__name:"CustomerEstimates",props:{isDialogVisible:{type:Boolean,required:!0},customerId:{type:Number,required:!0}},emits:["update:isDialogVisible"],setup(_,{emit:V}){const y=h=>{V("update:isDialogVisible",h)};return(h,k)=>{const B=z;return p(),f(G,{width:h.$vuetify.display.smAndDown?600:"90%","model-value":_.isDialogVisible,"onUpdate:modelValue":y},{default:l(()=>[t(B,{onClick:k[0]||(k[0]=L=>y(!1))}),_.customerId?(p(),f(J,{key:0},{default:l(()=>[t(Ye,{"customer-id":_.customerId},null,8,["customer-id"])]),_:1})):g("",!0)]),_:1},8,["width","model-value"])}}},Vt={__name:"CustomerInvoices",props:{isDialogVisible:{type:Boolean,required:!0},customerId:{type:Number,required:!0}},emits:["update:isDialogVisible"],setup(_,{emit:V}){const y=h=>{V("update:isDialogVisible",h)};return(h,k)=>{const B=z;return p(),f(G,{width:h.$vuetify.display.smAndDown?600:"90%","model-value":_.isDialogVisible,"onUpdate:modelValue":y},{default:l(()=>[t(B,{onClick:k[0]||(k[0]=L=>y(!1))}),_.customerId?(p(),f(J,{key:0},{default:l(()=>[t(Je,{"customer-id":_.customerId},null,8,["customer-id"])]),_:1})):g("",!0)]),_:1},8,["width","model-value"])}}};const _t={class:"me-3 d-flex gap-3"},gt={key:1,class:"text-grey text-caption align-self-center"},bt=["href"],Ct=["href"],yt={class:"d-flex align-center justify-space-between"},Dt=["onClick"],wt={key:0,class:"mx-3"},ll={__name:"Index",setup(_){const{customers:V,totalRecords:y,isLoading:h,fetchCustomers:k,deleteMultipleCustomer:B,updateCustomerStatus:L,currentPage:F,headers:d,deleteCustomer:n,itemsPerPage:E,searchQuery:P,filters:q,paginationData:O,customersByStatus:j}=Z(),m=C([]),s=C(!1),r=C(!1),S=C(!1),D=C(!1),u=C(!1),N=C(!1),M=C(!1),Y=C(!1),se=C(!0),ae=C(!1),w=C(0),ce=()=>{k()},pe=async(c,i)=>{await L(c,{status:i}),await k()},T=C([]),oe=()=>{const c=JSON.parse(localStorage.getItem("customers.table"));c?T.value=c.filter(i=>i.visible===!0):T.value=d};oe();const fe=async c=>{d.forEach(i=>{i.visible=c.includes(i.title)}),localStorage.setItem("customers.table",JSON.stringify(d)),oe()},ve=async c=>{w.value=c,r.value=!1,Y.value=!0},Ve=async c=>{w.value=c,r.value=!1,N.value=!0},_e=async c=>{w.value=c,r.value=!1,D.value=!0},ge=async c=>{w.value=c,r.value=!1,u.value=!0};ee(async()=>{window.innerWidth<768&&(T.value=d.slice(0,1),se.value=!1,ae.value=!0),await k()});const ie=c=>{w.value=c,s.value=!0},H=c=>{w.value=c,r.value=!0},ne=c=>{M.value=!0,w.value=c},be=()=>{M.value=!0},Ce=async c=>{if(c===!1){M.value=!1;return}m.value.length?(await B(m.value),m.value=[]):await n(w.value),M.value=!1,r.value=!1,await k()};return(c,i)=>{const ye=re,ue=Ue,Q=Le("IconBtn"),De=xe;return e(V)?(p(),f(J,{key:0,id:"invoice-list"},{default:l(()=>[t(te,{class:"d-flex align-center flex-wrap gap-4"},{default:l(()=>[t(le,null,{default:l(()=>[t(v,{lg:"3",md:"4",sm:"6",cols:"12"},{default:l(()=>[o("div",_t,[t($,{"prepend-icon":"tabler-plus",onClick:i[0]||(i[0]=a=>S.value=!0)},{default:l(()=>[I(" Create Customer ")]),_:1})])]),_:1}),t(v,{lg:"3",md:"6",sm:"6",cols:"12"},{default:l(()=>[t(ye,{modelValue:e(P),"onUpdate:modelValue":i[1]||(i[1]=a=>U(P)?P.value=a:null),label:"Search Customers",density:"compact"},null,8,["modelValue"])]),_:1}),t(v,{lg:"3",md:"6",sm:"6",cols:"12"},{default:l(()=>[t(ue,{modelValue:e(T),"onUpdate:modelValue":[i[2]||(i[2]=a=>U(T)?T.value=a:null),fe],label:"Select Column Visibility ",multiple:"",eager:"",items:e(d)},{selection:l(({item:a,index:A})=>[A<4?(p(),f(Ie,{key:0},{default:l(()=>[o("span",null,b(a.title),1)]),_:2},1024)):g("",!0),A===4?(p(),de("span",gt," (+"+b(e(T).length-4)+" others) ",1)):g("",!0)]),_:1},8,["modelValue","items"])]),_:1}),t(v,{lg:"2",md:"6",sm:"6"},{default:l(()=>[t(ue,{modelValue:e(q).lead_type,"onUpdate:modelValue":[i[3]||(i[3]=a=>e(q).lead_type=a),ce],label:"Select Lead Type",clearable:"","item-title":"name","item-value":"id","clear-icon":"tabler-x",items:e(me)},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(Oe),t(e(we),{modelValue:e(m),"onUpdate:modelValue":i[5]||(i[5]=a=>U(m)?m.value=a:null),"items-per-page":e(E),"onUpdate:itemsPerPage":i[6]||(i[6]=a=>U(E)?E.value=a:null),page:e(F),"onUpdate:page":i[7]||(i[7]=a=>U(F)?F.value=a:null),loading:e(h),"items-length":e(y),headers:e(T),"loading-text":"Loading... Please wait","show-select":e(se),items:e(V),class:"text-no-wrap"},{"item.email":l(({item:a})=>[o("a",{href:`mailto:${a.raw.email}`,class:"text-decoration-none"},b(a.raw.email),9,bt)]),"item.phone":l(({item:a})=>[o("a",{href:`tel:${a.raw.phone}`,class:"text-decoration-none"},b(a.raw.phone),9,Ct)]),"item.in_progress":l(({item:a})=>[t(Qe,{modelValue:a.raw.in_progress,"onUpdate:modelValue":A=>a.raw.in_progress=A,color:"primary",label:a.in_progress?"Yes":"No",onChange:A=>pe(a.raw.id,a.raw.in_progress)},null,8,["modelValue","onUpdate:modelValue","label","onChange"])]),"item.name":l(({item:a})=>[o("div",yt,[o("a",{href:"javascript:;",onClick:A=>H(a.raw.id)},b(a.raw.name),9,Dt),e(ae)?(p(),f(Q,{key:0,onClick:A=>H(a.raw.id)},{default:l(()=>[t(W,{icon:"tabler-eye"})]),_:2},1032,["onClick"])):g("",!0)])]),"item.actions":l(({item:a})=>[t(Q,{onClick:A=>ne(a.raw.id)},{default:l(()=>[t(W,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),t(Q,{onClick:A=>H(a.raw.id)},{default:l(()=>[t(W,{icon:"tabler-eye"})]),_:2},1032,["onClick"]),t(Q,{onClick:A=>ie(a.raw.id)},{default:l(()=>[t(W,{icon:"tabler-pencil"})]),_:2},1032,["onClick"])]),tfoot:l(()=>[e(m).length?(p(),de("div",wt,[e(m).length?(p(),f($,{key:0,color:"error",text:"",onClick:i[4]||(i[4]=a=>be(e(m)))},{default:l(()=>[I(" Delete Selected ("+b(e(m).length)+") ",1)]),_:1})):g("",!0)])):g("",!0)]),_:1},8,["modelValue","items-per-page","page","loading","items-length","headers","show-select","items"]),e(r)?(p(),f(pt,{key:0,isDialogVisible:e(r),"onUpdate:isDialogVisible":i[8]||(i[8]=a=>U(r)?r.value=a:null),"customer-id":e(w),onEditCustomer:ie,onDeleteCustomer:ne,onCreateEstimate:_e,onCreateInvoice:ge,onViewEstimates:ve,onViewInvoices:Ve},null,8,["isDialogVisible","customer-id"])):g("",!0),e(S)?(p(),f(Se,{key:1,isDialogVisible:e(S),"onUpdate:isDialogVisible":i[9]||(i[9]=a=>U(S)?S.value=a:null),"customer-id":e(w),onRefetchData:e(k)},null,8,["isDialogVisible","customer-id","onRefetchData"])):g("",!0),e(s)?(p(),f(ft,{key:2,isDialogVisible:e(s),"onUpdate:isDialogVisible":i[10]||(i[10]=a=>U(s)?s.value=a:null),"customer-id":e(w),onRefetchData:e(k)},null,8,["isDialogVisible","customer-id","onRefetchData"])):g("",!0),e(D)?(p(),f(Ee,{key:3,isDialogVisible:e(D),"onUpdate:isDialogVisible":i[11]||(i[11]=a=>U(D)?D.value=a:null),"customer-id":e(w)},null,8,["isDialogVisible","customer-id"])):g("",!0),e(u)?(p(),f(je,{key:4,isDialogVisible:e(u),"onUpdate:isDialogVisible":i[12]||(i[12]=a=>U(u)?u.value=a:null),"customer-id":e(w)},null,8,["isDialogVisible","customer-id"])):g("",!0),e(Y)?(p(),f(vt,{key:5,isDialogVisible:e(Y),"onUpdate:isDialogVisible":i[13]||(i[13]=a=>U(Y)?Y.value=a:null),"customer-id":e(w)},null,8,["isDialogVisible","customer-id"])):g("",!0),e(N)?(p(),f(Vt,{key:6,isDialogVisible:e(N),"onUpdate:isDialogVisible":i[14]||(i[14]=a=>U(N)?N.value=a:null),"customer-id":e(w)},null,8,["isDialogVisible","customer-id"])):g("",!0),t(De,{isDialogVisible:e(M),"onUpdate:isDialogVisible":i[15]||(i[15]=a=>U(M)?M.value=a:null),"cancel-title":"Cancelled","confirm-title":"Deleted","confirm-msg":"Customer deleted successfully.","confirmation-question":"Are you sure you want to delete selected customer(s)? This action cannot be undone.","cancel-msg":"Customer deletion cancelled.",onConfirm:Ce},null,8,["isDialogVisible"])]),_:1})):g("",!0)}}};export{ll as default};
