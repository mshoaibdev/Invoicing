import{_ as B}from"./DialogCloseBtn-478619bf.js";import{aB as V,aG as N,at as v,n as y,bk as a,y as o,bu as T,bt as U,bp as $,cp as g,b0 as l,cb as F,x as f,bx as _,aU as q,o as A,cq as M,ac as Y}from"./main-70b82271.js";import{V as L,r as w}from"./validators-f8585958.js";import{u as P}from"./invoices-9be41dd7.js";import"./index-628b2924.js";import{a as H,V as u}from"./VRow-498fad85.js";const z={__name:"SendInvoice",props:{isDialogVisible:{type:Boolean,required:!0},invoice:{type:Object,required:!0}},emits:["update:isDialogVisible","refetch"],setup(p,{emit:r}){const d=p,{sendInvoice:C,isLoading:m,respResult:x}=P(),n=V(""),i=V({to:d.invoice.customer.email,subject:"New Invoice",body:`Hello ${d.invoice.customer.name}, <br /> 
  You have received a new invoice from {COMPANY_NAME}. <br /> 
  You can pay using this link: {PAY_LINK} <br /> 
  <br />Please download using the button below:`}),D=()=>{i.value={from:"",to:"",subject:"",body:""},Y(()=>{var t,e;(t=n.value)==null||t.reset(),(e=n.value)==null||e.resetValidation()})},k=async()=>{await C(d.invoice.id,i.value),x.value.status===200&&(r("refetch"),r("update:isDialogVisible",!1),D())},S=async()=>{var t;(t=n.value)==null||t.validate().then(async({valid:e})=>{e&&k()})},c=t=>{r("update:isDialogVisible",t)};return(t,e)=>{const I=B,j=N("VuetifyTiptap");return v(),y(M,{width:t.$vuetify.display.smAndDown?1200:"40%","model-value":p.isDialogVisible,"onUpdate:modelValue":c},{default:a(()=>[o(I,{onClick:e[0]||(e[0]=s=>c(!1))}),d.invoice?(v(),y(T,{key:0,title:"Send Invoice"},{default:a(()=>[o(U,{title:"Send Invoice"},{default:a(()=>[o(L,{ref_key:"refForm",ref:n,onSubmit:$(S,["prevent"])},{default:a(()=>[o(H,null,{default:a(()=>[o(u,{cols:"12",lg:"12",md:"12",sm:"12"},{default:a(()=>[o(g,{modelValue:l(i).to,"onUpdate:modelValue":e[1]||(e[1]=s=>l(i).to=s),label:"To",rules:[l(w)]},null,8,["modelValue","rules"])]),_:1}),o(u,{cols:"12",lg:"12",md:"12",sm:"12"},{default:a(()=>[o(g,{modelValue:l(i).subject,"onUpdate:modelValue":e[2]||(e[2]=s=>l(i).subject=s),label:"Subject",rules:[l(w)]},null,8,["modelValue","rules"])]),_:1}),o(u,{cols:"12"},{default:a(()=>[o(F,null,{default:a(()=>[f("Body ")]),_:1}),o(j,{modelValue:l(i).body,"onUpdate:modelValue":e[3]||(e[3]=s=>l(i).body=s),rounded:"","max-height":465},null,8,["modelValue"])]),_:1}),o(u,{cols:"12",class:"d-flex flex-wrap gap-4 justify-end"},{default:a(()=>[o(_,{type:"submit",loading:l(m),disabled:l(m),onClick:e[4]||(e[4]=s=>{var b;return(b=l(n))==null?void 0:b.validate()})},{default:a(()=>[f(q(l(m)?"Sending...":"Send"),1)]),_:1},8,["loading","disabled"]),o(_,{color:"secondary",variant:"tonal",onClick:e[5]||(e[5]=s=>c(!1))},{default:a(()=>[f(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})):A("",!0)]),_:1},8,["width","model-value"])}}};export{z as _};
