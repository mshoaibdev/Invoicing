import{V as me,_ as pe}from"./VDataTableServer-84efd4e3.js";import{_ as ne}from"./AppTextField-9867e25c.js";import{l as fe,V as ge,_ as ie,u as Ve,d as ae,c as re,a as ve}from"./VTextarea-bfeb20e3.js";import{a as T}from"./axios-da837377.js";import{l as k}from"./parse-263515be.js";import{l as A}from"./index.m-120058be.js";import{r as m,ae as _e,k as ye,a5 as se,o as X,a as I,c as q,w as a,b as t,u as e,d as s,t as w,f as ue,h as R,a6 as be,V as z,g as G,af as je,e as De,U as B,E as oe}from"./main-c40ee4ed.js";import{V as Z,a as ee}from"./VCard-a375baf5.js";import{a as te,V as _}from"./VRow-db2c24e9.js";import{V as de}from"./VDialog-fe67dd57.js";import{_ as we}from"./AppDateTimePicker-4011cefb.js";import{V as Pe,r as F}from"./VForm-48297921.js";import{V as ke}from"./VDivider-e4e61359.js";import"./VCheckboxBtn-609a0dc2.js";import"./VSelectionControl-84b50376.js";import"./VInput-135e03cb.js";import"./transition-127812ba.js";import"./VTextField-1b1d5e52.js";import"./forwardRefs-9d31fcaa.js";import"./VImg-3d39c17f.js";import"./VList-4b19a862.js";import"./VAvatar-1c4c29a7.js";import"./VMenu-ebdbfbe8.js";import"./VOverlay-93ac4317.js";import"./_commonjsHelpers-725317a4.js";function le(){const p=m(!1),y=m(null),C=m(null),N=[{title:"#Project ID",key:"project_number",sortable:!1},{title:"Title",key:"title",sortable:!1},{title:"Project Type",key:"type",sortable:!1},{title:"Date Added",key:"added_date",sortable:!1},{title:"Last worked on",key:"last_worked_on",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Actions",key:"actions",sortable:!1}],c=_e({status:""}),h=m([]),P=m([]),V=m(10),x=m(0),j=m(1),o=m(1),S=[10,25,50,100],M=m(""),Y=m("id"),U=m(!0),f=m(null),l=m({}),D=m({}),v=ye(()=>{const d=h.value.length?(j.value-1)*V.value+1:0,u=h.value.length+(j.value-1)*V.value;return`Showing ${d} to ${u} of ${x.value} entries`}),O=()=>{C.value.refresh()},E=async d=>{try{p.value=!0;const u=await T.delete(A("projects.destroy",d));y.value=u,k.success(u.data.message)}catch(u){console.log(u),k.error("Error! Deleting project")}finally{p.value=!1}},n=async d=>{const u=await T.get(A("projects.show",d));l.value=u.data.data},L=async(d,u)=>{try{p.value=!0;const g=await T.post(A("projects.update",d),u);y.value=g,k.success(g.data.message)}catch(g){g.response.status===422&&(D.value=g.response.data.errors),k.error(g.response.data.message)}finally{p.value=!1}},W=async(d,u)=>{try{p.value=!0;const g=await T.post(A("projects.status",d),u);y.value=g,k.success(g.data.message)}catch(g){console.log(g),g.response.status===422&&k.error(g.response.data.message)}finally{p.value=!1}},Q=async d=>{p.value=!0,await T.post(A("projects.store"),d).then(u=>{y.value=u,k.success(u.data.message)}).catch(u=>{y.value=u,u.response.status===422&&k.error(u.response.data.message)}).finally(()=>{p.value=!1})},J=async()=>{p.value=!0;try{const d=await T.get(A("projects.index"),{params:{q:M.value,perPage:V.value,page:j.value,sortBy:Y.value,sortDesc:U.value,...c}}),{total:u,last_page:g}=d.data.meta;o.value=g,h.value=d.data.data,x.value=u}catch(d){k.error(d.response.data.message)}finally{p.value=!1}},H=async()=>{p.value=!0;try{const d=await T.get(A("projects.count-by-status"));P.value=d.data.data}catch(d){k.error(d.response.data.message)}finally{p.value=!1}},b=async d=>{p.value=!0;try{const u=await T.get(A("projects.index"),{params:{...c}});h.value=u.data.data}catch(u){k.error(u.response.data.message)}finally{p.value=!1}},r=fe.debounce(()=>{J()},500);return se(M,()=>{r()}),se([j,V,c],()=>{J()}),{projectData:l,isLoading:p,errors:D,getProject:n,projectId:f,sortBy:Y,itemsPerPage:V,totalPages:o,filters:c,paginationData:v,respResult:y,fetchProjectsByStatus:H,projects:h,projectsByStatus:P,fetchProjects:J,deleteProject:E,refetchData:O,updateProject:L,currentPage:j,searchQuery:M,refListTable:C,totalRecords:x,headers:N,isSortDirDesc:U,perPageOptions:S,storeProject:Q,fetchProjectsList:b,updateProjectStatus:W}}const K=[{name:"Initiated",id:"Initiated"},{name:"Completed",id:"Completed"},{name:"In Progress",id:"In Progress"},{name:"Paused",id:"Paused"}],Ce=s("p",{class:"text-sm text-uppercase text-disabled"}," Project Details ",-1),he=s("th",null," Project Title: ",-1),xe=s("th",null," Assign User: ",-1),Se={key:0},Ue=s("th",null," Contact Info: ",-1),$e=s("th",null," Pricing: ",-1),Ie=s("th",null," Timing: ",-1),Te=s("th",null," Type: ",-1),Ae=s("th",null," Status: ",-1),Be=s("th",null," Date Added At: ",-1),Fe=s("th",null," Last Work On: ",-1),Ne=s("th",null," Notes: ",-1),Le={__name:"View",props:{isDialogVisible:{type:Boolean,required:!0},projectId:{type:Number,required:!0}},emits:["update:isDialogVisible","editCustomer","deleteCustomer"],setup(p,{emit:y}){const C=p,{getProject:N,projectData:c,isLoading:h}=le();X(async()=>{C.isDialogVisible&&await N(C.projectId)});const P=V=>{y("update:isDialogVisible",V)};return(V,x)=>{const j=ie;return I(),q(de,{width:V.$vuetify.display.smAndDown?600:"60%","model-value":p.isDialogVisible,"onUpdate:modelValue":P},{default:a(()=>[t(j,{onClick:x[0]||(x[0]=o=>P(!1))}),e(c).user?(I(),q(Z,{key:0},{default:a(()=>[t(ee,null,{default:a(()=>[t(te,null,{default:a(()=>[t(_,{cols:"12",lg:"12",md:"12",sm:"12"},{default:a(()=>[Ce,t(ge,null,{default:a(()=>[s("tbody",null,[s("tr",null,[he,s("td",null,w(e(c).title),1)]),s("tr",null,[xe,e(c).user?(I(),ue("td",Se,w(e(c).user.name),1)):R("",!0)]),s("tr",null,[Ue,s("td",null,w(e(c).contact_info),1)]),s("tr",null,[$e,s("td",null,w(e(c).price),1)]),s("tr",null,[Ie,s("td",null,w(e(c).time),1)]),s("tr",null,[Te,s("td",null,w(e(c).type),1)]),s("tr",null,[Ae,s("td",null,w(e(c).status),1)]),s("tr",null,[Be,s("td",null,w(e(c).added_date),1)]),s("tr",null,[Fe,s("td",null,w(e(c).last_worked_on),1)]),s("tr",null,[Ne,s("td",null,w(e(c).description),1)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0)]),_:1},8,["width","model-value"])}}},Re={__name:"Add",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["refetchData","update:isDialogVisible"],setup(p,{emit:y}){const C=p,{storeProject:N,errors:c,respResult:h,isLoading:P}=le(),{users:V,fetchUsersList:x}=Ve();X(async()=>{C.isDialogVisible&&await x()});const j={title:"",description:"",contact_info:"",price:"",time:"",type:"",user_id:"",added_date:"",last_worked_on:"",status:""},o=m({...j}),S=m(),M=()=>{o.value={...j},je(()=>{var f,l;(f=S.value)==null||f.reset(),(l=S.value)==null||l.resetValidation()})},Y=async()=>{var f;(f=S.value)==null||f.validate().then(async({valid:l})=>{if(l){const D=new FormData;for(const v in o.value)Object.hasOwnProperty.call(o.value,v)&&D.append(v,o.value[v]);await N(D),h.value.status===200&&(y("refetchData"),y("update:isDialogVisible",!1),M())}})},U=f=>{y("update:isDialogVisible",f)};return(f,l)=>{const D=ie,v=ne,O=re,E=we;return I(),q(de,{width:f.$vuetify.display.smAndDown?"auto":1e3,"model-value":C.isDialogVisible,persistent:"","onUpdate:modelValue":U},{default:a(()=>[t(D,{onClick:l[0]||(l[0]=n=>U(!1))}),t(Z,{title:"Add New Project"},{default:a(()=>[t(ee,null,{default:a(()=>[t(Pe,{ref_key:"refForm",ref:S,onSubmit:be(Y,["prevent"])},{default:a(()=>[t(te,null,{default:a(()=>[t(_,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:e(o).title,"onUpdate:modelValue":l[1]||(l[1]=n=>e(o).title=n),label:"Project Title",rules:[e(F)]},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(O,{modelValue:e(o).user_id,"onUpdate:modelValue":l[2]||(l[2]=n=>e(o).user_id=n),label:"Assign User","item-title":"name","item-value":"id",items:e(V),rules:[e(F)]},null,8,["modelValue","items","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:e(o).price,"onUpdate:modelValue":l[3]||(l[3]=n=>e(o).price=n),label:"Project Price",rules:[e(F)]},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:e(o).time,"onUpdate:modelValue":l[4]||(l[4]=n=>e(o).time=n),label:"Project Timing",rules:[e(F)]},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:e(o).type,"onUpdate:modelValue":l[5]||(l[5]=n=>e(o).type=n),label:"Project Type",rules:[e(F)]},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(O,{modelValue:e(o).status,"onUpdate:modelValue":l[6]||(l[6]=n=>e(o).status=n),label:"Project Status",rules:[e(F)],"item-title":"name","item-value":"id",items:e(K)},null,8,["modelValue","rules","items"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(E,{modelValue:e(o).added_date,"onUpdate:modelValue":l[7]||(l[7]=n=>e(o).added_date=n),rules:[e(F)],density:"compact",placeholder:"Select Date",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",disableMobile:!0}},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"6"},{default:a(()=>[t(E,{modelValue:e(o).last_worked_on,"onUpdate:modelValue":l[8]||(l[8]=n=>e(o).last_worked_on=n),rules:[e(F)],density:"compact",placeholder:"Last Work Date",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",disableMobile:!0}},null,8,["modelValue","rules"])]),_:1}),t(_,{cols:"12",md:"12"},{default:a(()=>[t(ae,{modelValue:e(o).contact_info,"onUpdate:modelValue":l[9]||(l[9]=n=>e(o).contact_info=n),clearable:"","clear-icon":"tabler-circle-x",label:"Contact Info"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",md:"12"},{default:a(()=>[t(ae,{modelValue:e(o).description,"onUpdate:modelValue":l[10]||(l[10]=n=>e(o).description=n),clearable:"","clear-icon":"tabler-circle-x",label:"Notes"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",class:"d-flex flex-wrap gap-4 justify-end"},{default:a(()=>[t(z,{type:"submit",loading:e(P),disabled:e(P),onClick:l[11]||(l[11]=n=>{var L;return(L=e(S))==null?void 0:L.validate()})},{default:a(()=>[G(" Submit ")]),_:1},8,["loading","disabled"]),t(z,{color:"secondary",variant:"tonal",onClick:l[12]||(l[12]=n=>U(!1))},{default:a(()=>[G(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},qe={class:"me-3 d-flex gap-3"},Me={key:1,class:"text-grey text-caption align-self-center"},Oe={class:"d-flex align-center"},Ee=["onClick"],Ye={class:"d-flex align-center"},Vt={__name:"Index",setup(p){const{projects:y,totalRecords:C,isLoading:N,fetchProjects:c,updateProjectStatus:h,currentPage:P,headers:V,deleteProject:x,itemsPerPage:j,searchQuery:o,filters:S,paginationData:M,projectsByStatus:Y}=le(),U=m([]);m(!1);const f=m(!1),l=m(!1),D=m(!1),v=m(0),O=()=>{c()},E=async(b,r)=>{await h(b,{status:r}),await c()},n=m([]),L=()=>{const b=JSON.parse(localStorage.getItem("projects.table"));b?n.value=b.filter(r=>r.visible===!0):n.value=V};L();const W=async b=>{V.forEach(r=>{r.visible=b.includes(r.title)}),localStorage.setItem("projects.table",JSON.stringify(V)),L()};X(async()=>{await c()});const Q=b=>{v.value=b,f.value=!0},J=b=>{D.value=!0,v.value=b},H=async b=>{if(b===!1){D.value=!1;return}await x(v.value),D.value=!1,f.value=!1,await c()};return(b,r)=>{const d=re,u=ne,g=De("IconBtn"),ce=pe;return e(y)?(I(),q(Z,{key:0,id:"invoice-list"},{default:a(()=>[t(ee,{class:"d-flex align-center flex-wrap gap-4"},{default:a(()=>[t(te,null,{default:a(()=>[t(_,{lg:"3",md:"3",sm:"4",cols:"12"},{default:a(()=>[s("div",qe,[t(z,{"prepend-icon":"tabler-plus",onClick:r[0]||(r[0]=i=>l.value=!0)},{default:a(()=>[G(" Create Project ")]),_:1})])]),_:1}),t(_,{lg:"3",md:"6",sm:"8",cols:"12"},{default:a(()=>[t(d,{modelValue:e(n),"onUpdate:modelValue":[r[1]||(r[1]=i=>B(n)?n.value=i:null),W],label:"Select Column Visibility ",multiple:"",eager:"",items:e(V)},{selection:a(({item:i,index:$})=>[$<4?(I(),q(ve,{key:0},{default:a(()=>[s("span",null,w(i.title),1)]),_:2},1024)):R("",!0),$===4?(I(),ue("span",Me," (+"+w(e(n).length-4)+" others) ",1)):R("",!0)]),_:1},8,["modelValue","items"])]),_:1}),t(_,{lg:"3",md:"3",cols:"12",sm:"6"},{default:a(()=>[t(u,{modelValue:e(o),"onUpdate:modelValue":r[2]||(r[2]=i=>B(o)?o.value=i:null),label:"Search Projects",density:"compact"},null,8,["modelValue"])]),_:1}),t(_,{lg:"2",md:"3",sm:"6",cols:"12"},{default:a(()=>[t(d,{modelValue:e(S).status,"onUpdate:modelValue":[r[3]||(r[3]=i=>e(S).status=i),O],items:e(K),"item-title":"name","item-value":"id",label:"Filter by Status",clearable:"","clear-icon":"tabler-x",density:"compact","single-line":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(ke),t(e(me),{modelValue:e(U),"onUpdate:modelValue":r[4]||(r[4]=i=>B(U)?U.value=i:null),"items-per-page":e(j),"onUpdate:itemsPerPage":r[5]||(r[5]=i=>B(j)?j.value=i:null),page:e(P),"onUpdate:page":r[6]||(r[6]=i=>B(P)?P.value=i:null),loading:e(N),"items-length":e(C),headers:e(n),items:e(y),class:"text-no-wrap"},{"item.title":a(({item:i})=>[s("div",Oe,[s("a",{href:"javascript:;",onClick:$=>Q(i.raw.id)},w(i.raw.title),9,Ee)])]),"item.status":a(({item:i})=>[s("div",Ye,[t(d,{modelValue:i.raw.status,"onUpdate:modelValue":[$=>i.raw.status=$,$=>E(i.raw.id,$)],items:e(K),"item-title":"name","item-value":"id"},null,8,["modelValue","onUpdate:modelValue","items"])])]),"item.actions":a(({item:i})=>[t(g,{onClick:$=>J(i.raw.id)},{default:a(()=>[t(oe,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),t(g,{onClick:$=>Q(i.raw.id)},{default:a(()=>[t(oe,{icon:"tabler-eye"})]),_:2},1032,["onClick"])]),_:1},8,["modelValue","items-per-page","page","loading","items-length","headers","items"]),e(f)?(I(),q(Le,{key:0,isDialogVisible:e(f),"onUpdate:isDialogVisible":r[7]||(r[7]=i=>B(f)?f.value=i:null),"project-id":e(v)},null,8,["isDialogVisible","project-id"])):R("",!0),e(l)?(I(),q(Re,{key:1,isDialogVisible:e(l),"onUpdate:isDialogVisible":r[8]||(r[8]=i=>B(l)?l.value=i:null),"project-id":e(v),onRefetchData:e(c)},null,8,["isDialogVisible","project-id","onRefetchData"])):R("",!0),t(ce,{isDialogVisible:e(D),"onUpdate:isDialogVisible":r[9]||(r[9]=i=>B(D)?D.value=i:null),"cancel-title":"Cancelled","confirm-title":"Deleted","confirm-msg":"Project deleted successfully.","confirmation-question":"Are you sure you want to delete this project? This action cannot be undone.","cancel-msg":"Project deletion cancelled.",onConfirm:H},null,8,["isDialogVisible"])]),_:1})):R("",!0)}}};export{Vt as default};
